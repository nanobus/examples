compute:
  - uses: wasmrs
    with:
      filename: build/jot-go.wasm
      # filename: build/jot-rust.wasm

specs:
  - uses: apex
    with:
      filename: apex.aidl

services:

  'nanochat.io.v1.jots.Jots':

    postJot:
      steps:
        - name: Authorize
          uses: authorize
          with:
            has: [sub]
        - name: Invoke
          uses: invoke

    getFeed:
      steps:
        - name: Authorize
          uses: authorize
          with:
            has: [sub]
        - name: Invoke
          uses: invoke

    deleteJot:
      steps:
        - name: Authorize
          uses: authorize
          with:
            has: [sub]
        - name: Invoke
          uses: invoke
    
    like:
      steps:
        - name: Authorize
          uses: authorize
          with:
            has: [sub]
        - name: Invoke
          uses: invoke
    
    unlike:
      steps:
        - name: Authorize
          uses: authorize
          with:
            has: [sub]
        - name: Invoke
          uses: invoke

  'nanochat.io.v1.jots.Users':
    me:
      steps:
        - name: Authorize
          uses: authorize
          with:
            has: [sub]
        - name: Invoke
          uses: invoke

    follow:
      steps:
        - name: Authorize
          uses: authorize
          with:
            has: [sub]
        - name: Invoke
          uses: invoke

    unfollow:
      steps:
        - name: Authorize
          uses: authorize
          with:
            has: [sub]
        - name: Invoke
          uses: invoke
